let t,e,n,r,i,o,l,a,s,g,u,d,c,m,h,p,f,T,y,E;var v={};Object.defineProperty(v,"__esModule",{value:!0}),v.setEnergy=void 0;var b={};Object.defineProperty(b,"__esModule",{value:!0}),b.rescale=b.get=void 0,b.get=function(t,e){if(!t.has(e))throw Error(`Key ${e} not found in map`);return t.get(e)},b.rescale=function(t,e,n,r,i){return(i-t)*r/(e+0)+n};var S={};function M(t,e,n,r,i){let o="";if(void 0!=i&&(o+="\n"+i),o+="<"+t,e)for(let[t,n]of e)o+=" "+t+'="'+n.toString()+'"';return n&&r&&(o+=" "+n+'="'+r.toString()+'"'),o+">"}function C(t,e,n){let r="";return n&&void 0!=e&&(r+="\n"+e),r+"</"+t+">"}Object.defineProperty(S,"__esModule",{value:!0}),S.toHTML=S.getSingularElement=S.getAttributes=S.getTag=S.getEndTag=S.getStartTag=S.getNodeValue=S.getFirstChildNode=S.getFirstElement=S.getAttribute=void 0,S.getAttribute=function(t,e){let n=t.getAttribute(e);if(!n)throw Error(e+" attribute not found");return n},S.getFirstElement=function(t,e){let n=t.getElementsByTagName(e)[0];if(null==n)throw Error(e+" element not found");return n},S.getFirstChildNode=function(t){let e=t.childNodes;if(null==e)throw Error("Element has no childNodes");return e[0]},S.getNodeValue=function(t){let e=t.nodeValue;if(null==e)throw Error("nodeValue is null");return e},S.getStartTag=M,S.getEndTag=C,S.getTag=function(t,e,n,r,i,o,l){return M(e,n,r,i,o)+t+C(e,o,l)},S.getAttributes=function(t){let e=t.getAttributeNames(),n=new Map;return e.forEach(function(e){let r=t.getAttribute(e);null!=r&&n.set(e,r)}),n},S.getSingularElement=function(t,e){let n=t.getElementsByTagName(e);if(1!=n.length)throw Error("Expecting 1 "+e+" but finding "+n.length);return n[0]},S.toHTML=function(t){return t.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br>").replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;").replace(/  /g,"&nbsp;&nbsp;")};var D={};Object.defineProperty(D,"__esModule",{value:!0}),D.Molecule=D.DOSCMethod=D.EnergyTransferModel=D.DeltaEDown=D.Property=D.Bond=D.Atom=void 0;var w={};Object.defineProperty(w,"__esModule",{value:!0}),w.NumberArrayWithAttributes=w.NumberWithAttributes=w.Attributes=void 0;var N={};function A(t){return"<tr>"+t+"</tr>\n"}Object.defineProperty(N,"__esModule",{value:!0}),N.getSelfClosingTag=N.getInput=N.getDiv=N.getTable=N.getTR=N.getTD=N.getTH=void 0,N.getTH=function(t){var e="";for(let n=0;n<t.length;n++)e+="<th>"+t[n]+"</th>";return A(e)},N.getTD=function(t,e=!1){let n="<td";return e&&(n+=' contenteditable="true"'),n+=">"+t+"</td>"},N.getTR=A,N.getTable=function(t){return"<table>"+t+"</table>"},N.getDiv=function(t,e,n){let r="<div";return null!==e&&(r+=' id="'+e+'"'),null!==n&&(r+=' class="'+n+'"'),r+">"+t+"</div>"},N.getInput=function(t,e,n,r){let i='<input type="'+t+'"';return null!==e&&(i+=' id="'+e+'"'),null!==n&&(i+=' onchange="'+n+'"'),null!==r&&(i+=' value="'+r+'"'),i+">"},N.getSelfClosingTag=function(t,e){let n="<"+e;if(t)for(let[e,r]of t)n+=" "+e+'="'+r+'"';return n+" />"};class R{attributes;constructor(t){this.attributes=t}toString(){let t=this.constructor.name+"(";return this.attributes.forEach((e,n)=>{t+=`${n}(${e}), `}),t}toTag(t,e){let n=(0,N.getSelfClosingTag)(this.attributes,t);return e?"\n"+e+n:"\n"+n}toXML(t,e){return(0,S.getTag)("",t,this.attributes,void 0,void 0,e,!1)}}w.Attributes=R,w.NumberWithAttributes=class extends R{value;constructor(t,e){super(t),this.value=e}toString(){return super.toString()+`, ${this.value.toString()})`}toXML(t,e){return(0,S.getTag)(this.value.toString().trim(),t,this.attributes,void 0,void 0,e,!1)}},w.NumberArrayWithAttributes=class extends R{values;delimiter=",";constructor(t,e,n){super(t),this.values=e,n&&(this.delimiter=n)}toString(){return super.toString()+`, ${this.values.toString()})`}setDelimiter(t){this.delimiter=t}toXML(t,e){return(0,S.getTag)(this.values.toString().replaceAll(",",this.delimiter),t,this.attributes,void 0,void 0,e,!1)}};var x={};Object.defineProperty(x,"__esModule",{value:!0}),x.isNumeric=x.toNumberArray=x.arrayToString=x.mapToString=void 0,x.mapToString=function(t){return null==t?"":Array.from(t.entries()).map(([t,e])=>`${null==t?"null":t.toString()}(${null==e?"null":e.toString()})`).join(", ")},x.arrayToString=function(t,e){return null==t?"":(null==e&&(e=", "),t.map(t=>null==t?"null":t.toString()).join(e))},x.toNumberArray=function(t){let e=[];for(let n=0;n<t.length;n++)e.push(parseFloat(t[n]));return e},x.isNumeric=function(t){return!isNaN(parseFloat(t))};class L extends w.Attributes{constructor(t){if(super(t),void 0==t.get("id"))throw Error("id is undefined");if(void 0==t.get("elementType"))throw Error("elementType is undefined")}toString(){return super.toString()+")"}get id(){return this.attributes.get("id")}get elementType(){return this.attributes.get("elementType")}}D.Atom=L;class P extends w.Attributes{constructor(t){super(t)}toString(){return super.toString()+")"}}D.Bond=P;class B extends w.Attributes{property;constructor(t,e){super(t),this.property=e}toString(){return super.toString()+` property(${this.property.toString()}))`}toXML(t,e){let n;return(void 0!=t&&void 0!=e&&(n=e+t),this.property instanceof w.NumberWithAttributes)?(0,S.getTag)(this.property.toXML("scalar",n),"property",this.attributes,void 0,void 0,e,!0):(0,S.getTag)(this.property.toXML("array",n),"property",this.attributes,void 0,void 0,e,!0)}}D.Property=B;class O extends w.NumberWithAttributes{constructor(t,e){super(t,e)}}D.DeltaEDown=O;class I extends w.Attributes{deltaEDown;constructor(t,e){super(t),this.deltaEDown=e}toXML(t,e){return void 0==t?(0,S.getTag)(this.deltaEDown.toXML("me.deltaEDown",e),"me:energyTransferModel",this.attributes,void 0,void 0,e,!1):(0,S.getTag)(this.deltaEDown.toXML("me.deltaEDown",e),"energyTransferModel",void 0,void 0,void 0,e,!0)}}D.EnergyTransferModel=I,D.DOSCMethod=class{type;constructor(t){this.type=t}toString(){return`DOSCMethod(type(${this.type}))`}toTag(t){let e=`<me.DOSCMethod xsi:type="${this.type}"/>`;return t?"\n"+t+e:"\n"+e}};class _ extends w.Attributes{id;atoms;bonds;properties;energyTransferModel;dOSCMethod;constructor(t,e,n,r,i,o){super(t);let l=this.attributes.get("id");if(void 0==l)throw Error("id is undefined");this.id=l,this.atoms=e,this.bonds=n,this.properties=r,this.energyTransferModel=i,this.dOSCMethod=o}toString(){let t=`Molecule(id(${this.getID()}), `,e=this.getDescription();void 0!=e&&(t+=`description(${e}), `);let n=this.getActive();return void 0!=n&&(t+=`active(${n}), `),this.atoms.size>0&&(t+=`atoms(${(0,x.mapToString)(this.atoms)}), `),this.bonds.size>0&&(t+=`bonds(${(0,x.mapToString)(this.bonds)}), `),this.properties.size>0&&(t+=`properties(${(0,x.mapToString)(this.properties)}), `),this.energyTransferModel&&(t+=`energyTransferModel(${this.energyTransferModel.toString()}), `),this.dOSCMethod&&(t+=`dOSCMethod(${this.dOSCMethod.toString()}), `),t+")"}getID(){return this.attributes.get("id")}getDescription(){return this.attributes.get("description")}getActive(){let t=this.attributes.get("active");return void 0!=t||t}getEnergy(){let t=this.properties.get("me:ZPE");if(void 0==t)return 0;if(t.property instanceof w.NumberWithAttributes)return t.property.value;throw Error("Expected a PropertyScalar but got a PropertyArray and not sure how to handle that.")}setEnergy(t){let e=this.properties.get("me:ZPE");if(void 0==e)throw Error("No me.ZPE property found");if(e.property instanceof w.NumberArrayWithAttributes)throw Error("Expected a NumberWithAttributes but got a NumberArrayWithAttributes and not sure how to handle that.");e.property.value=t}getRotationConstants(){let t=this.properties.get("me:rotConsts");return void 0!=t?null==t.property?void 0:t.property instanceof w.NumberWithAttributes?[t.property.value]:t.property.values:t}getVibrationFrequencies(){let t=this.properties.get("me:vibFreqs");return void 0!=t?t.property instanceof w.NumberWithAttributes?[t.property.value]:t.property instanceof w.NumberArrayWithAttributes?t.property.values:void 0:t}toXML(t,e,n){let r="",i="",o="",l="";void 0!=e&&void 0!=n&&(l=(o=(i=(r=e.repeat(n))+e)+e)+e);let a="";for(let t of this.atoms.values())a+=t.toTag("atom",o);this.atoms.size>1&&""!=a&&(a=(0,S.getTag)(a,"atomArray",void 0,void 0,void 0,i,!0));let s="";for(let t of this.bonds.values())s+=t.toTag("bond",o);""!=s&&(s=(0,S.getTag)(s,"bondArray",void 0,void 0,void 0,i,!0));let g="";this.properties.forEach(t=>{let e="";t.property instanceof w.NumberWithAttributes?e+=t.property.toXML("scalar",l):e+=t.property.toXML("array",l),g+=(0,S.getTag)(e,"property",t.attributes,void 0,void 0,o,!0)}),this.properties.size>1&&""!=g&&(g=(0,S.getTag)(g,"propertyList",void 0,void 0,void 0,i,!0));let u="";this.energyTransferModel&&(u=this.energyTransferModel.toXML(e,i));let d="";return this.dOSCMethod&&(d=this.dOSCMethod.toTag(i)),(0,S.getTag)(a+s+g+u+d,t,this.attributes,void 0,void 0,r,!0)}}D.Molecule=_;var $={};Object.defineProperty($,"__esModule",{value:!0}),$.Reaction=$.ZhuNakamuraCrossing=$.MesmerILT=$.MCRCMethod=$.Tunneling=$.NInfinity=$.TInfinity=$.ActivationEnergy=$.PreExponential=$.TransitionState=$.Product=$.Reactant=$.ReactionMolecule=void 0;class G extends w.Attributes{molecule;constructor(t,e){super(t),this.molecule=e}toXML(t,e,n){let r="";void 0!=e&&void 0!=n&&(r=n+e);let i=this.toTag("molecule",r);return(0,S.getTag)(i,t,void 0,void 0,void 0,n,!0)}}$.ReactionMolecule=G,$.Reactant=class extends G{constructor(t,e){super(t,e)}},$.Product=class extends G{constructor(t,e){super(t,e)}},$.TransitionState=class extends G{constructor(t,e){super(t,e)}getRef(){let t=this.attributes.get("ref");if(null==t)throw Error('Attribute "ref" is undefined.');return t}};class X extends w.NumberWithAttributes{constructor(t,e){super(t,e)}}$.PreExponential=X;class F extends w.NumberWithAttributes{constructor(t,e){super(t,e)}}$.ActivationEnergy=F;class H extends w.NumberWithAttributes{constructor(t,e){super(t,e)}}$.TInfinity=H;class k extends w.NumberWithAttributes{constructor(t,e){super(t,e)}}$.NInfinity=k;class z extends w.Attributes{constructor(t){super(t)}}$.Tunneling=z;class W extends w.Attributes{mCRCMethodName;constructor(t,e){super(t),this.mCRCMethodName=e}toString(){return`MCRCMethod(name(${this.mCRCMethodName}))`}}$.MCRCMethod=W;class V extends W{preExponential;activationEnergy;tInfinity;nInfinity;constructor(t,e,n,r,i){super(t,"MesmerILT"),this.preExponential=e,this.activationEnergy=n,this.tInfinity=r,this.nInfinity=i}toString(){return`MesmerILT(${super.toString()}, preExponential(${this.preExponential}), activationEnergy(${this.activationEnergy}), TInfinity(${this.tInfinity}), nInfinity(${this.nInfinity}))`}toXML(t,e){let n="";void 0!=e&&(n=e+"  ");let r="";void 0!=this.preExponential&&(r=this.preExponential.toXML("me.preExponential",n));let i="";void 0!=this.activationEnergy&&(i=this.activationEnergy.toXML("me.activationEnergy",n));let o="";void 0!=this.tInfinity&&(o=this.tInfinity.toXML("me.nInfinity",n));let l="";return void 0!=this.nInfinity&&(l=this.nInfinity.toXML("me.nInfinity",n)),(0,S.getTag)(r+i+o+l,t,this.attributes,void 0,void 0,e,!0)}}$.MesmerILT=V,$.ZhuNakamuraCrossing=class extends W{harmonicReactantDiabat_FC;harmonicReactantDiabat_XO;harmonicProductDiabat_DE;exponentialProductDiabat_A;exponentialProductDiabat_B;exponentialProductDiabat_DE;constructor(t,e,n,r,i,o,l){super(t,"ZhuNakamuraCrossing"),this.harmonicReactantDiabat_FC=e,this.harmonicReactantDiabat_XO=n,this.harmonicProductDiabat_DE=r,this.exponentialProductDiabat_A=i,this.exponentialProductDiabat_B=o,this.exponentialProductDiabat_DE=l}toString(){return`ZhuNakamuraCrossing(${super.toString()}, harmonicReactantDiabat_FC(${this.harmonicReactantDiabat_FC.toString()}), harmonicReactantDiabat_XO(${this.harmonicReactantDiabat_XO.toString()}), harmonicProductDiabat_DE(${this.harmonicProductDiabat_DE.toString()}), exponentialProductDiabat_A(${this.exponentialProductDiabat_A.toString()}), exponentialProductDiabat_B(${this.exponentialProductDiabat_B.toString()}), exponentialProductDiabat_DE(${this.exponentialProductDiabat_DE.toString()}))`}};class j extends w.Attributes{id;reactants;products;mCRCMethod;transitionState;tunneling;constructor(t,e,n,r,i,o,l){super(t),this.id=e,this.reactants=n,this.products=r,this.mCRCMethod=i,this.transitionState=o,this.tunneling=l}toString(){return super.toString(),super.toString()+`id(${this.id}), `+`reactants(${(0,x.mapToString)(this.reactants)}), `+`products(${(0,x.mapToString)(this.products)}), `+`mCRCMethod(${this.mCRCMethod?.toString()}), `+`transitionState(${this.transitionState?.toString()}), `+`tunneling(${this.tunneling?.toString()}))`}getReactantsLabel(){return Array.from(this.reactants.values()).map(t=>t.molecule.id).join(" + ")}getReactantsEnergy(){return Array.from(this.reactants.values()).map(t=>t.molecule.getEnergy()).reduce((t,e)=>t+e,0)}getProductsLabel(){return Array.from(this.products.values()).map(t=>t.molecule.id).join(" + ")}getProductsEnergy(){return Array.from(this.products.values()).map(t=>t.molecule.getEnergy()).reduce((t,e)=>t+e,0)}getLabel(){return this.getReactantsLabel()+" -> "+this.getProductsLabel()}toXML(t,e,n){let r="",i="";void 0!=e&&void 0!=n&&(i=(r=e.repeat(n))+e);let o="";this.reactants.forEach(t=>{o+=t.toXML("reactant",e,i)});let l="";this.products.forEach(t=>{l+=t.toXML("product",e,i)});let a="";void 0!=this.tunneling&&(a=this.tunneling.toTag("me.tunneling",i));let s="";void 0!=this.transitionState&&(s=this.transitionState.toXML("transitionState",e,i));let g="";return void 0!=this.mCRCMethod&&(g=this.mCRCMethod instanceof V?this.mCRCMethod.toXML("mCRCMethod",i):this.mCRCMethod.toTag("mCRCMethod",i)),(0,S.getTag)(o+l+a+s+g,t,this.attributes,void 0,void 0,r,!0)}}$.Reaction=j;var U={};function Z(t,e,n,r,i,o,l){t.beginPath(),t.strokeStyle=e,t.lineWidth=n,t.moveTo(r,i),t.lineTo(o,l),t.stroke()}function q(t,e,n,r,i,o){t.save(),t.translate(i,o),t.scale(1,-1),t.font=n,t.fillStyle=r,t.fillText(e,0,0),t.restore()}function J(t,e,n){return t.font=n,t.measureText(e).width}Object.defineProperty(U,"__esModule",{value:!0}),U.getTextWidth=U.getTextHeight=U.writeText=U.drawLine=U.drawLevel=void 0,U.drawLevel=function(t,e,n,r,i,o,l,a,s,g,u){let d=r+(o-r)/2;q(t,u,a,e,d-J(t,u,a)/2,l+s),q(t,g,a,e,d-J(t,g,a)/2,l+3*s),Z(t,e,n,r,i,o,l)},U.drawLine=Z,U.writeText=q,U.getTextHeight=function(t,e,n){t.font=n;var r=t.measureText(e);return r.actualBoundingBoxAscent+r.actualBoundingBoxDescent},U.getTextWidth=J;var K={};Object.defineProperty(K,"__esModule",{value:!0}),K.Conditions=K.BathGas=K.PTpair=void 0;class Q extends w.Attributes{P;T;constructor(t){super(t);let e=t.get("P");if(e)this.P=parseFloat(e);else throw Error("P is undefined");let n=t.get("T");if(n)this.T=parseFloat(n);else throw Error("T is undefined")}}K.PTpair=Q;class Y extends $.ReactionMolecule{constructor(t,e){super(t,e)}}K.BathGas=Y,K.Conditions=class{bathGas;pTs;constructor(t,e){this.bathGas=t,this.pTs=e}toString(){return`Conditions(bathGas(${this.bathGas.toString()}), pTs(${this.pTs.toString()}))`}toXML(t,e){let n="";void 0!=t&&void 0!=e&&(n=e+t);let r=this.bathGas.toXML("bathGas",t,n);return this.pTs.forEach(t=>{r+=t.toTag("PTpair",n)}),(0,S.getTag)(r,"conditions",void 0,void 0,void 0,e,!0)}};var tt={};Object.defineProperty(tt,"__esModule",{value:!0}),tt.ModelParameters=tt.GrainSize=void 0;class te extends w.NumberWithAttributes{constructor(t,e){super(t,e)}toString(){return`GrainSize(${super.toString()})`}}tt.GrainSize=te,tt.ModelParameters=class{grainSize;energyAboveTheTopHill;constructor(t,e){this.grainSize=t,this.energyAboveTheTopHill=e}toString(){return`ModelParameters(grainSize(${this.grainSize.toString()}), energyAboveTheTopHill(${this.energyAboveTheTopHill.toString()}))`}toXML(t,e){let n="";void 0!=t&&void 0!=e&&(n=e+t);let r=this.grainSize.toXML("me:GrainSize",n);return r+=(0,S.getTag)(this.energyAboveTheTopHill.toString(),"me:EnergyAboveTheTopHill",void 0,void 0,void 0,n,!1),(0,S.getTag)(r,"me:modelParameters",void 0,void 0,void 0,e,!0)}};var tn={};Object.defineProperty(tn,"__esModule",{value:!0}),tn.Control=tn.DiagramEnergyOffset=void 0;class tr extends w.NumberWithAttributes{constructor(t,e){super(t,e)}}tn.DiagramEnergyOffset=tr,tn.Control=class{testDOS;printSpeciesProfile;testMicroRates;testRateConstant;printGrainDOS;printCellDOS;printReactionOperatorColumnSums;printTunnellingCoefficients;printGrainkfE;printGrainBoltzmann;printGrainkbE;eigenvalues;hideInactive;diagramEnergyOffset;constructor(t,e,n,r,i,o,l,a,s,g,u,d,c,m){this.testDOS=t,this.printSpeciesProfile=e,this.testMicroRates=n,this.testRateConstant=r,this.printGrainDOS=i,this.printCellDOS=o,this.printReactionOperatorColumnSums=l,this.printTunnellingCoefficients=a,this.printGrainkfE=s,this.printGrainBoltzmann=g,this.printGrainkbE=u,this.eigenvalues=d,this.hideInactive=c,this.diagramEnergyOffset=m}toString(){return`Control(testDOS(${this.testDOS?.toString()}), printSpeciesProfile(${this.printSpeciesProfile?.toString()}), testMicroRates(${this.testMicroRates?.toString()}), testRateConstant(${this.testRateConstant?.toString()}), printGrainDOS(${this.printGrainDOS?.toString()}), printCellDOS(${this.printCellDOS?.toString()}), printReactionOperatorColumnSums(${this.printReactionOperatorColumnSums?.toString()}), printTunnellingCoefficients(${this.printTunnellingCoefficients?.toString()}), printGrainkfE(${this.printGrainkfE?.toString()}), printGrainBoltzmann(${this.printGrainBoltzmann?.toString()}), printGrainkbE(${this.printGrainkbE?.toString()}), eigenvalues(${this.eigenvalues?.toString()}), hideInactive(${this.hideInactive?.toString()}))`}toXML(t,e){let n="";void 0!=t&&void 0!=e&&(n=e+t);let r="\n";return r+=n+(0,N.getSelfClosingTag)(null,"me:testDOS")+"\n"+(n+(0,N.getSelfClosingTag)(null,"me:printSpeciesProfile"))+"\n"+(n+(0,N.getSelfClosingTag)(null,"me:testMicroRates"))+"\n"+(n+(0,N.getSelfClosingTag)(null,"me:testRateConstant"))+"\n"+(n+(0,N.getSelfClosingTag)(null,"me:printGrainDOS"))+"\n"+(n+(0,N.getSelfClosingTag)(null,"me:printCellDOS"))+"\n"+(n+(0,N.getSelfClosingTag)(null,"me:printReactionOperatorColumnSums"))+"\n"+(n+(0,N.getSelfClosingTag)(null,"me:printTunnellingCoefficients"))+"\n"+(n+(0,N.getSelfClosingTag)(null,"me:printGrainkfE"))+"\n"+(n+(0,N.getSelfClosingTag)(null,"me:printGrainBoltzmann"))+"\n"+(n+(0,N.getSelfClosingTag)(null,"me:printGrainkbE"))+"\n"+(n+(0,N.getSelfClosingTag)(null,"me:eigenvalues"))+"\n"+(n+(0,N.getSelfClosingTag)(null,"me:hideInactive"))+this.diagramEnergyOffset?.toXML("me:diagramEnergyOffset",n),(0,S.getTag)(r,"control",void 0,void 0,null,e,!0)}},"serviceWorker"in navigator&&window.addEventListener("load",function(){let t=new URL("../../../sw.js",document.baseURI);navigator.serviceWorker.register(t)});let ti="me:title",to=new Map([]),tl=-1/0,ta=1/0,ts=new Map([]);const tg=`<?xml version="1.0" encoding="utf-8" ?>
<?xml-stylesheet type='text/xsl' href='../../mesmer2.xsl' media='other'?>
<?xml-stylesheet type='text/xsl' href='../../mesmer1.xsl' media='screen'?>`;function tu(t){let e=t.id,n=e.split("_")[0],r=to.get(n);if(void 0!=r){let i=parseFloat(t.value);isNaN(i)?(alert("Energy input for "+n+" is not a number"),document.getElementById(e).value=r.getEnergy().toString()):(r.setEnergy(i),console.log("Energy of "+n+" set to "+i))}}document.addEventListener("DOMContentLoaded",v=>{h=document.getElementById("xml_title"),p=document.getElementById("xml_text"),window.loadXML=function(){!function v(){(f=document.createElement("input")).type="file",f.onchange=function(){if(f.files){for(let t=0;t<f.files.length;t++)console.log("inputElement.files["+t+"]="+f.files[t]);let i=f.files[0];if(console.log(i.name),r=i.name,null!=p){let o=new FileReader,f=0,v="";o.onload=function(M){if(!M.target)throw Error("Event target is null");if(v+=M.target.result,null!=i){if(f<i.size){let t=i.slice(f,f+1048576);o.readAsText(t),f+=1048576}else{var C;C=v=v.trim(),null!=h&&(h.innerHTML=r),null!=p&&(p.innerHTML=(0,S.toHTML)(C)),function(r){let i,o,h,p,f,v,M,C,A,R,L,P,B,O,I;e="\n";let _=r.documentElement;if(null==_)throw Error("Document element not found");{let t=_.tagName;e+="<"+t,console.log(t),n=(0,S.getEndTag)(t,"",!0);let r=!0,i=" ".repeat(t.length+2);_.getAttributeNames().forEach(function(t){let n=_.getAttribute(t),o=`${t}="${n}"`;r?(r=!1,e+=" "+o):e+="\n"+i+o}),e+=">"}(function(e){if(null==(l=e.getElementsByTagName(ti)))throw Error(ti+" not found");if(1!=l.length)throw Error("Multiple "+ti+" elements found");{console.log("Title="+(t=(t=l[0].childNodes[0].nodeValue).trim()));let e=document.getElementById("title");null!=e&&(e.innerHTML=t)}})(r),function(t){let e="moleculeList";console.log(e);let n=(0,S.getSingularElement)(t,e);null!=(a=document.getElementById("molecules_title"))&&(a.innerHTML="Molecules");let r=new Set;if(n.childNodes.forEach(function(t){r.add(t.nodeName)}),1!=r.size&&!(2==r.size&&r.has("#text")))throw console.error("moleculeListTagNames:"),r.forEach(t=>console.error(t)),Error("Additional tag names in moleculeList:");if(!r.has("molecule"))throw Error("Expecting molecule tagName but it is not present!");let i=n.getElementsByTagName("molecule");console.log("Number of molecules="+i.length);for(let t=0;t<i.length;t++){let e,n,r,o=(0,S.getAttributes)(i[t]),l=new Set;i[t].childNodes.forEach(function(t){l.add(t.nodeName)});let a=new Map;l.delete("atom"),l.delete("atomArray");let s=i[t].getElementsByTagName("atom");for(let t=0;t<s.length;t++){let e=(0,S.getAttributes)(s[t]),n=e.get("id");if(void 0!=n){let t=new D.Atom(e);a.set(n,t)}}l.delete("bond"),l.delete("bondArray");let g=new Map,u=i[t].getElementsByTagName("bond");for(let t=0;t<u.length;t++){let e=(0,S.getAttributes)(u[t]),n=e.get("atomRefs2");if(void 0!=n){let t=new D.Bond(e);g.set(n,t)}}let d=new Map;l.delete("property"),l.delete("propertyList");let c=i[t].getElementsByTagName("property");for(let t=0;t<c.length;t++){let e=(0,S.getAttributes)(c[t]),n=c[t].children;if(1!=n.length)throw Error("Expecting 1 child but finding "+n.length);let r=(0,S.getAttributes)(n[0]),i=n[0].nodeName,o=n[0].textContent;if(null==o)throw console.error("nodeName"),Error("textContent is null");o=o.trim();let a=e.get("dictRef");if(null==a)throw Error("dictRef is null");if("scalar"==i){l.delete("scalar");let t=parseFloat(o);d.set(a,new D.Property(e,new w.NumberWithAttributes(r,t))),"me:ZPE"===a&&(ta=Math.min(ta,t),tl=Math.max(tl,t))}else if("array"==i)l.delete("array"),d.set(a,new D.Property(e,new w.NumberArrayWithAttributes(r,(0,x.toNumberArray)(o.split(/\s+/))," ")));else if("matrix"==i);else throw Error("Unexpected nodeName: "+i)}if(l.delete("me:energyTransferModel"),null!=(r=i[t].getElementsByTagName("me:energyTransferModel"))&&r.length>0){if(1!=r.length)throw Error("energyTransferModel length="+r.length);let t=r[0].getElementsByTagName("me:deltaEDown");if(null!=t){if(1!=t.length)throw Error("deltaEDown length="+t.length);let n=parseFloat((0,S.getNodeValue)((0,S.getFirstChildNode)(t[0]))),i=new D.DeltaEDown((0,S.getAttributes)(t[0]),n);e=new D.EnergyTransferModel((0,S.getAttributes)(r[0]),i)}}if(l.delete("me:DOSCMethod"),null!=(r=i[t].getElementsByTagName("me:DOSCMethod"))){let t=r[0];if(null!=t&&null!=t){let e=t.getAttribute("xsi:type");null!=e&&(n=new D.DOSCMethod(e))}}if(l.delete("#text"),l.size>0)throw console.error("Remaining moleculeTagNames:"),l.forEach(t=>console.error(t)),Error("Unexpected tags in molecule.");let m=new D.Molecule(o,a,g,d,e,n);to.set(m.id,m)}to.forEach(function(t,e){let n=e+"_energy",r=document.getElementById(n);r&&r.addEventListener("change",r=>{let i=r.target.value;(0,x.isNumeric)(i)?(t.setEnergy(parseFloat(i)),console.log("Set energy of "+e+" to "+i+" kJ/mol")):(alert("Energy input for "+e+" is not a number"),document.getElementById(n).value=t.getEnergy().toString(),console.log("inputValue="+i),console.log("Type of inputValue: "+typeof i))})})}(r),function(){if(0==to.size)return;let t=(0,N.getTH)(["Name","Energy<br>kJ/mol","Rotation constants<br>cm<sup>-1</sup>","Vibration frequencies<br>cm<sup>-1</sup>"]);to.forEach(function(e,n){let r,i=e.getEnergy();r=null==i?"":i.toString();let o="",l=e.getRotationConstants();void 0!=l&&(o=(0,x.arrayToString)(l," "));let a="",s=e.getVibrationFrequencies();void 0!=s&&(a=(0,x.arrayToString)(s," ")),t+=(0,N.getTR)((0,N.getTD)(n)+(0,N.getTD)((0,N.getInput)("number",n+"_energy","setEnergy(this)",r))+(0,N.getTD)(o,!0)+(0,N.getTD)(a,!0))}),null!==(s=document.getElementById("molecules_table"))&&(s.innerHTML=t)}(),function(t){let e="reactionList";console.log(e);let n=(0,S.getSingularElement)(t,e).getElementsByTagName("reaction"),r=n.length;if(console.log("Number of reactions="+r),0==r)throw Error("No reactions: There should be at least 1!");null!=(g=document.getElementById("reactions_title"))&&(g.innerHTML="Reactions");for(let t=0;t<r;t++){let e=(0,S.getAttributes)(n[t]),r=e.get("id");if(null==r)throw Error("reactionID is null");if(null!=r){let i,o,l;console.log("id="+r);let a=new Map([]),s=n[t].getElementsByTagName("reactant");for(let t=0;t<s.length;t++){let e=(0,S.getFirstElement)(s[t],"molecule"),n=(0,S.getAttribute)(e,"ref");a.set(n,new $.Reactant((0,S.getAttributes)(e),(0,b.get)(to,n)))}let g=new Map([]),u=n[t].getElementsByTagName("product");for(let t=0;t<u.length;t++){let e=(0,S.getFirstElement)(u[t],"molecule"),n=(0,S.getAttribute)(e,"ref");g.set(n,new $.Product((0,S.getAttributes)(e),(0,b.get)(to,n)))}let d=n[t].getElementsByTagName("me:MCRCMethod");if(d.length>0){let t=(0,S.getAttributes)(d[0]),e=t.get("name");if(null==e){let e=t.get("xsi:type");if(null!=e&&"me:MesmerILT"===e){let e,n,r,o;let l=d[0].getElementsByTagName("me:preExponential");if(null!=l&&null!=l[0]){let t=parseFloat((0,S.getNodeValue)((0,S.getFirstChildNode)(l[0])));e=new $.PreExponential((0,S.getAttributes)(l[0]),t)}let a=d[0].getElementsByTagName("me:activationEnergy");if(null!=a&&null!=a[0]){let t=parseFloat((0,S.getNodeValue)((0,S.getFirstChildNode)(a[0])));n=new $.ActivationEnergy((0,S.getAttributes)(a[0]),t)}let s=d[0].getElementsByTagName("me:TInfinity");if(null!=s&&null!=s[0]){let t=parseFloat((0,S.getNodeValue)((0,S.getFirstChildNode)(s[0])));r=new $.NInfinity((0,S.getAttributes)(s[0]),t)}let g=d[0].getElementsByTagName("me:nInfinity");if(null!=g&&null!=g[0]){let t=parseFloat((0,S.getNodeValue)((0,S.getFirstChildNode)(g[0])));o=new $.NInfinity((0,S.getAttributes)(g[0]),t)}i=new $.MesmerILT(t,e,n,r,o)}}else i=new $.MCRCMethod(t,e)}let c=n[t].getElementsByTagName("me:transitionState");if(c.length>0){let t=c[0].getElementsByTagName("molecule")[0],e=t.getAttribute("ref");o=new $.TransitionState((0,S.getAttributes)(t),(0,b.get)(to,e))}let m=n[t].getElementsByTagName("me:tunneling");m.length>0&&(l=new $.Tunneling((0,S.getAttributes)(m[0])));let h=new $.Reaction(e,r,a,g,i,o,l);ts.set(r,h)}}}(r),function(){if(0==ts.size)return;let t=(0,N.getTH)(["ID","Reactants","Products","Transition State","PreExponential","Activation Energy","TInfinity","NInfinity"]);ts.forEach(function(e,n){let r=(0,x.arrayToString)(Array.from(e.reactants.keys())," "),i=(0,x.arrayToString)(Array.from(e.products.keys())," "),o="",l="",a="",s="",g="";if(void 0!=e.transitionState){let t=e.transitionState.attributes.get("name");null!=t&&(o=t)}if(void 0!=e.mCRCMethod){if(e.mCRCMethod instanceof $.MesmerILT)null!=e.mCRCMethod.preExponential&&(l=e.mCRCMethod.preExponential.value.toString()+" "+e.mCRCMethod.preExponential.attributes.get("units")),null!=e.mCRCMethod.activationEnergy&&(a=e.mCRCMethod.activationEnergy.value.toString()+" "+e.mCRCMethod.activationEnergy.attributes.get("units")),null!=e.mCRCMethod.tInfinity&&(s=e.mCRCMethod.tInfinity.toString()),null!=e.mCRCMethod.nInfinity&&(g=e.mCRCMethod.nInfinity.value.toString());else if("RRKM"==e.mCRCMethod.attributes.get("name"));else throw Error("Unexpected mCRCMethod: "+e.mCRCMethod)}t+=(0,N.getTR)((0,N.getTD)(n)+(0,N.getTD)(r)+(0,N.getTD)(i)+(0,N.getTD)(o)+(0,N.getTD)(l,!0)+(0,N.getTD)(a,!0)+(0,N.getTD)(s,!0)+(0,N.getTD)(g,!0)),null!==(u=document.getElementById("reactions_table"))&&(u.innerHTML=t)})}(),function(){if(ts.size>1){null!=(d=document.getElementById("reactions_diagram_title"))&&(d.innerHTML="Diagram");let t=document.getElementById("reactions_diagram");null!=t&&(t.style.display="block",function(t,e,n,r,i,o,l){let a,s,g,u;console.log("drawReactionDiagram");let d="black",c=t.getContext("2d"),m=(0,U.getTextHeight)(c,"Aj",i),h=new Set,p=new Set,f=new Set,T=new Set,y=new Map,E=new Map,v=0,S=Number.MAX_VALUE,M=Number.MIN_VALUE;n.forEach(function(t,e){let n=t.transitionState,r=t.getReactantsLabel();h.add(r),p.has(r)&&f.add(r);let i=t.getReactantsEnergy();S=Math.min(S,i),M=Math.max(M,i),E.set(r,i);let o=t.getProductsLabel();if(p.add(o),i=t.getProductsEnergy(),S=Math.min(S,i),M=Math.max(M,i),E.set(o,i),!y.has(r)&&(y.set(r,v),v++),y.has(o)){v--;let t=(0,b.get)(y,o);if(y.forEach(function(e,n){e>t&&y.set(n,e-1)}),void 0!=n){let t=n.getRef();T.add(t),y.set(t,v),i=n.molecule.getEnergy(),S=Math.min(S,i),M=Math.max(M,i),E.set(t,i),v++}y.set(o,v),v++}else{if(void 0!=n){let t=n.getRef();T.add(t),y.set(t,v),i=n.molecule.getEnergy(),S=Math.min(S,i),M=Math.max(M,i),E.set(t,i),v++}y.set(o,v),v++}});let C=M-S,D=[];y.forEach(function(t,e){D[t]=e});let w=0,N=0,A=new Map,R=new Map,x=new Map,L=new Map,P=new Map,B=new Map;D.forEach(function(e){let n=(0,b.get)(E,e),r=(0,b.rescale)(S,C,0,t.height,n);u=Math.max((0,U.getTextWidth)(c,n.toString(),i),(0,U.getTextWidth)(c,e,i)),s=w+u+5,g=a=r+4,A.set(e,[w,a]),R.set(e,[s,g]),p.has(e)&&(x.set(e,[w,a]),L.set(e,[s,g])),T.has(e)&&(P.set(e,[w,a]),B.set(e,[s,g])),w=s+10,N=s}),t.width=N;let O=t.height+4*m+8,I=t.height;t.height=O,c.transform(1,0,0,-1,0,O),n.forEach(function(t,e){let n=t.transitionState,r=t.getReactantsLabel(),i=t.getProductsLabel(),o=(0,b.get)(R,r),l=(0,b.get)(x,i);if(void 0!=n){let t=n.getRef(),e=(0,b.get)(P,t);(0,U.drawLine)(c,d,2,o[0],o[1],e[0],e[1]);let r=(0,b.get)(B,t);(0,U.drawLine)(c,d,2,r[0],r[1],l[0],l[1])}else(0,U.drawLine)(c,d,2,o[0],o[1],l[0],l[1])}),h.forEach(function(t){let e=(0,b.get)(E,t),n=(0,b.rescale)(S,C,0,I,e),r=(0,b.get)(A,t)[0],l=n+4,a=(0,b.get)(R,t)[0],s=e.toString();(0,U.drawLevel)(c,"blue",o,r,l,a,l,i,m,t,s)}),p.forEach(function(t){let e=(0,b.get)(E,t),n=(0,b.rescale)(S,C,0,I,e),r=(0,b.get)(x,t)[0],l=n+o,a=(0,b.get)(L,t)[0],s=e.toString();f.has(t)?(0,U.drawLevel)(c,"orange",o,r,l,a,l,i,m,t,s):(0,U.drawLevel)(c,"green",o,r,l,a,l,i,m,t,s)}),T.forEach(function(t){let e=(0,b.get)(E,t),n=(0,b.rescale)(S,C,0,I,e),r=(0,b.get)(P,t)[0],l=n+o,a=(0,b.get)(B,t)[0],s=e.toString();(0,U.drawLevel)(c,"red",o,r,l,a,l,i,m,t,s)})}(t,0,ts,0,"14px Arial",4,2))}}(),function(t){let e="me:conditions";console.log(e);let n=(0,S.getSingularElement)(t,e);null!=(c=document.getElementById("conditions_title"))&&(c.innerHTML="Conditions");let r=(0,S.getSingularElement)(n,"me:bathGas"),i=(0,S.getAttributes)(r),o=new K.BathGas(i,(0,b.get)(to,r.childNodes[0].nodeValue)),l=(0,S.getSingularElement)(n,"me:PTs").getElementsByTagName("me:PTpair"),a=[];for(let t=0;t<l.length;t++)a.push(new K.PTpair((0,S.getAttributes)(l[t])));T=new K.Conditions(o,a)}(r),null!=(i=document.getElementById("bathGas"))&&(i.innerHTML="Bath Gas "+T.bathGas.molecule.getID()),o=document.getElementById("PT_table"),h=(0,N.getTH)(["P","T"]),null!=o&&(T.pTs.forEach(function(t){h+=(0,N.getTR)((0,N.getTD)(t.P.toString())+(0,N.getTD)(t.T.toString()))}),o.innerHTML=h),console.log(p="me:modelParameters"),f=(0,S.getSingularElement)(r,p),null!=(m=document.getElementById("modelParameters_title"))&&(m.innerHTML="Model Parameters"),v=(0,S.getSingularElement)(f,"me:grainSize"),M=(0,S.getAttributes)(v),C=parseFloat((0,S.getNodeValue)((0,S.getFirstChildNode)(v))),A=new tt.GrainSize(M,C),R=(0,S.getSingularElement)(f,"me:energyAboveTheTopHill"),L=parseFloat((0,S.getNodeValue)((0,S.getFirstChildNode)(R))),y=new tt.ModelParameters(A,L),P=document.getElementById("modelParameters_table"),B=(0,N.getTH)(["Parameter","Value"])+((0,N.getTR)((0,N.getTD)("Grain Size")+(0,N.getTD)(y.grainSize.value.toString()))+(0,N.getTR)((0,N.getTD)("Energy Above The Top Hill")+(0,N.getTD)(y.energyAboveTheTopHill.toString()))),null!=P&&(P.innerHTML=B),function(t){let e,n,r,i,o,l,a,s,g,u,d,c,m,h,p="me:control";console.log(p);let f=(0,S.getSingularElement)(t,p),T=document.getElementById("control_title");null!=T&&(T.innerHTML="Control"),f.getElementsByTagName("me:testDOS").length>0&&(e=!0),f.getElementsByTagName("me:printSpeciesProfile").length>0&&(n=!0),f.getElementsByTagName("me:testMicroRates").length>0&&(r=!0),f.getElementsByTagName("me:testRateConstant").length>0&&(i=!0),f.getElementsByTagName("me:printGrainDOS").length>0&&(o=!0),f.getElementsByTagName("me:printCellDOS").length>0&&(l=!0),f.getElementsByTagName("me:printReactionOperatorColumnSums").length>0&&(a=!0),f.getElementsByTagName("me:printTunnellingCoefficients").length>0&&(s=!0),f.getElementsByTagName("me:printGrainkfE").length>0&&(g=!0),f.getElementsByTagName("me:printGrainBoltzmann").length>0&&(u=!0),f.getElementsByTagName("me:printGrainkbE").length>0&&(d=!0);let y=f.getElementsByTagName("me:eigenvalues");y.length>0&&(c=parseFloat((0,S.getNodeValue)((0,S.getFirstChildNode)(y[0])))),f.getElementsByTagName("me:hideInactive").length>0&&(m=!0);let v=f.getElementsByTagName("me:diagramEnergyOffset");if(v.length>0){let t=parseFloat((0,S.getNodeValue)((0,S.getFirstChildNode)(v[0])));h=new tn.DiagramEnergyOffset((0,S.getAttributes)(v[0]),t)}E=new tn.Control(e,n,r,i,o,l,a,s,g,u,d,c,m,h)}(r),O=document.getElementById("control_table"),I=(0,N.getTH)(["Control","Value"]),void 0!=E.testDOS&&(I+=(0,N.getTR)((0,N.getTD)("me.testDOS")+(0,N.getTD)(""))),void 0!=E.printSpeciesProfile&&(I+=(0,N.getTR)((0,N.getTD)("me.printSpeciesProfile")+(0,N.getTD)(""))),void 0!=E.testMicroRates&&(I+=(0,N.getTR)((0,N.getTD)("me.testMicroRates")+(0,N.getTD)(""))),void 0!=E.testRateConstant&&(I+=(0,N.getTR)((0,N.getTD)("me.testRateConstant")+(0,N.getTD)(""))),void 0!=E.printGrainDOS&&(I+=(0,N.getTR)((0,N.getTD)("me.printGrainDOS")+(0,N.getTD)(""))),void 0!=E.printCellDOS&&(I+=(0,N.getTR)((0,N.getTD)("me.printCellDOS")+(0,N.getTD)(""))),void 0!=E.printReactionOperatorColumnSums&&(I+=(0,N.getTR)((0,N.getTD)("me.printReactionOperatorColumnSums")+(0,N.getTD)(""))),void 0!=E.printTunnellingCoefficients&&(I+=(0,N.getTR)((0,N.getTD)("me.printTunnellingCoefficients")+(0,N.getTD)(""))),void 0!=E.printGrainkfE&&(I+=(0,N.getTR)((0,N.getTD)("me.printGrainkfE")+(0,N.getTD)(""))),void 0!=E.printGrainBoltzmann&&(I+=(0,N.getTR)((0,N.getTD)("me.printGrainBoltzmann")+(0,N.getTD)(""))),void 0!=E.printGrainkbE&&(I+=(0,N.getTR)((0,N.getTD)("me.printGrainkbE")+(0,N.getTD)(""))),void 0!=E.eigenvalues&&(I+=(0,N.getTR)((0,N.getTD)("me.eigenvalues")+(0,N.getTD)(E.eigenvalues.toString()))),void 0!=E.hideInactive&&(I+=(0,N.getTR)((0,N.getTD)("me.hideInactive")+(0,N.getTD)(""))),void 0!=E.diagramEnergyOffset&&(I+=(0,N.getTR)((0,N.getTD)("me.diagramEnergyOffset")+(0,N.getTD)(E.diagramEnergyOffset.value.toString()))),null!=O&&(O.innerHTML=I)}(new DOMParser().parseFromString(v,"text/xml")),fetch("http://localhost:1234/",{method:"POST",headers:{"Content-Type":"text/xml"},body:v}).then(t=>{if(!t.ok)throw Error(`HTTP error! status: ${t.status}`);return t.text()}).then(t=>{console.log("Server response:",t)}).catch(t=>{console.error("There was a problem with the fetch operation:",t)})}}};let M=i.slice(f,f+1048576);o.readAsText(M),f+=1048576}}},f.click(),null!=(i=document.getElementById("load_button"))&&i.addEventListener("click",v),null!=(o=document.getElementById("saveButton"))&&(o.style.display="inline")}()}}),v.setEnergy=tu,window.setEnergy=tu,window.saveXML=function(){let i;console.log("saveXML"),"  ".repeat(2);let o="\n  "+(0,S.getTag)(t,"me:title");i=2;let l="";to.forEach(function(t,e){l+=t.toXML("molecule","  ",i)}),l=(0,S.getTag)(l,"moleculeList",void 0,void 0,void 0,"  ",!0),i=2;let a="";ts.forEach(function(t,e){a+=t.toXML("reaction","  ",i)}),a=(0,S.getTag)(a,"reactionList",void 0,void 0,void 0,"  ",!0);let s=T.toXML("  ","  "),g=y.toXML("  ","  "),u=E.toXML("  ","  "),d=new Blob([tg,e,o,l,a,s,g,u,n],{type:"text/plain"}),c=URL.createObjectURL(d),m=document.createElement("a");m.href=c,m.download=r,document.body.appendChild(m),m.click(),document.body.removeChild(m)};
//# sourceMappingURL=GUI.289169c6.js.map
